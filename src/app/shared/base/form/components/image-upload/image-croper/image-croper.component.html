<app-base-modal [title]="'Crop'">
    <div modal-body>
        <app-loader [show]="loading">
            <div class="mb-3">
                <button class="btn btn-icon btn-icon-sm btn-clean mr-2" (click)="zoomIn()" [container]="'body'"
                    ngbTooltip="Zoom In">
                    <svg version="1.0" width="30px" height="30px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <g>
                            <path fill="#171C37" d="M62.1,18.8c-23.9,0-43.3,19.4-43.3,43.3s19.4,43.3,43.3,43.3s43.3-19.4,43.3-43.3
           C105.5,38.2,86.1,18.8,62.1,18.8z M62.1,100.5c-21.2,0-38.4-17.2-38.4-38.4s17.2-38.4,38.4-38.4s38.4,17.2,38.4,38.4
           S83.3,100.5,62.1,100.5z" />
                            <path fill="#171C37"
                                d="M108.4,105.3L92,88.6l-3.4,3.3l16.4,16.7c0.9,0.9,2.4,0.9,3.3,0l0,0C109.3,107.7,109.3,106.3,108.4,105.3z" />
                            <path fill="#171C37" d="M64.4,64.4h25.5c1.2,0,2.2-1,2.2-2.2s-1-2.2-2.2-2.2H64.4V34.4c0-1.2-1-2.2-2.2-2.2s-2.2,1-2.2,2.2v25.5
           H34.5c-1.2,0-2.2,1-2.2,2.2c0,0.6,0.2,1.2,0.6,1.6c0.4,0.4,1,0.6,1.6,0.6H60v25.5c0,0.6,0.2,1.2,0.6,1.6s1,0.6,1.6,0.6
           c1.2,0,2.2-1,2.2-2.2L64.4,64.4z" />
                        </g>
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2" (click)="zoomOut()" [container]="'body'"
                    ngbTooltip="Zoom Out">
                    <svg version="1.0" width="30px" height="30px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <g>
                            <g>
                                <path fill="#171C37" d="M62.1,18.8c-23.9,0-43.3,19.4-43.3,43.3s19.4,43.3,43.3,43.3s43.3-19.4,43.3-43.3
           C105.5,38.2,86.1,18.8,62.1,18.8z M62.1,100.5c-21.2,0-38.4-17.2-38.4-38.4s17.2-38.4,38.4-38.4s38.4,17.2,38.4,38.4
           S83.3,100.5,62.1,100.5z" />
                                <path fill="#171C37" d="M108.4,105.3L92,88.6l-3.4,3.3l16.4,16.7c0.9,0.9,2.4,0.9,3.3,0l0,0C109.3,107.7,109.3,106.3,108.4,105.3z
           " />
                                <path fill="#171C37" d="M34.2,64.4c-0.6,0-1.2-0.2-1.6-0.7s-0.7-1-0.7-1.6c0-1.2,1-2.2,2.2-2.2h55.6c1.2,0,2.2,1,2.2,2.2
           s-1,2.2-2.2,2.2L34.2,64.4z" />
                            </g>
                        </g>
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2 pt-1" (click)="resetImage()"
                    [container]="'body'" ngbTooltip="Reset">
                    <svg version="1.0" width="27px" height="27px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <g>
                            <path fill="#171C37" d="M55.2,104.2C29.8,104.2,9,83.5,9,58s20.7-46.2,46.2-46.2c16.5,0,31.8,8.9,40,23.2c0.7,1.3,0.3,2.9-1,3.6
       c-1.3,0.7-2.9,0.3-3.6-1c-7.3-12.7-20.9-20.5-35.5-20.5c-22.5,0-40.9,18.3-40.9,40.9c0.1,22.6,18.5,41,41,41s40.9-18.3,40.9-40.9
       c0-1.5,1.2-2.6,2.6-2.6s2.6,1.2,2.6,2.6C101.4,83.5,80.7,104.2,55.2,104.2z" />
                        </g>
                        <g>
                            <path fill="#0058A8" d="M102.5,46.5H77.7c-1.7,0-2.5-2-1.3-3.2l24.8-24.8c1.2-1.2,3.2-0.3,3.2,1.3v24.8
       C104.4,45.6,103.5,46.5,102.5,46.5z" />
                        </g>
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2 " (click)="rotateLeft()" [container]="'body'"
                    ngbTooltip="Rotate Left">
                    <svg version="1.0" width="29px" height="29px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <g>
                            <path fill="#0058A8" d="M62.2,80.3h10.2v6.3H55.7V58.1h6.5V80.3z" />
                            <path fill="#171C37" d="M85.7,44.4c-9.1-9.1-22.5-12.7-35-9.3c-1.4,0.4-2.2,1.8-1.9,3.2c0.4,1.4,1.8,2.2,3.2,1.9
  c10.6-2.9,22.1,0.2,29.8,8c5.7,5.7,8.9,13.3,9,21.4c0.1,7.9-2.9,15.6-8.3,21.4c-5.9,6.3-13.9,9.8-22.5,9.8c-8.2,0-16-3.2-21.8-9
  c-0.3-0.3-0.7-0.7-1-1.1c-1-1.1-2.8-1.2-3.9-0.1l0,0c-1,1-1,2.6-0.1,3.6c0.4,0.4,0.8,0.9,1.2,1.3c6.8,6.8,15.9,10.6,25.5,10.6
  s18.7-3.8,25.5-10.6C92.2,88.7,96,79.6,96,70C96.2,60.3,92.5,51.2,85.7,44.4z" />
                            <path fill="#0058A8" d="M56.7,50.4v-27c0-1.3-1.6-2-2.5-1L40.8,35.9c-0.6,0.6-0.6,1.5,0,2.1l13.5,13.5
  C55.1,52.3,56.7,51.7,56.7,50.4z" />
                        </g>
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2 " (click)="rotateRight()" [container]="'body'"
                    ngbTooltip="Rotate Right">

                    <svg version="1.0" width="30px" height="30px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <g>
                            <path fill="#0058A8" d="M70.6,86.6l-5.4-9.4h-3.1v9.4h-6.5V58.1H67c2.7,0,5,1,6.9,2.8c1.9,1.9,2.8,4.2,2.8,6.9
  c0,1.7-0.5,3.3-1.4,4.8c-1,1.5-2.2,2.6-3.8,3.4l6.1,10.5L70.6,86.6L70.6,86.6z M62.2,64.2v7.3h4.9c0.9,0,1.7-0.4,2.3-1.1
  c0.6-0.7,1-1.6,1-2.6s-0.3-1.9-1-2.6c-0.6-0.7-1.4-1.1-2.3-1.1L62.2,64.2L62.2,64.2z" />
                            <path fill="#171C37" d="M42.3,44.4c9.1-9.1,22.5-12.7,35-9.3c1.4,0.4,2.2,1.8,1.9,3.2c-0.4,1.4-1.8,2.2-3.2,1.9
  c-10.6-2.9-22.1,0.2-29.8,8c-5.7,5.7-8.9,13.3-9,21.4C37,77.4,39.9,85.2,45.3,91c5.9,6.3,13.9,9.8,22.5,9.8c8.2,0,16-3.2,21.8-9
  c0.3-0.3,0.7-0.7,1-1.1c1-1.1,2.8-1.2,3.9-0.1l0,0c1,1,1,2.6,0.1,3.6c-0.4,0.4-0.8,0.9-1.2,1.3c-6.8,6.8-15.9,10.6-25.5,10.6
  s-18.7-3.8-25.5-10.6C35.6,88.7,31.8,79.6,31.8,70C31.8,60.3,35.5,51.2,42.3,44.4z" />
                            <path fill="#0058A8" d="M71.3,50.4v-27c0-1.3,1.6-2,2.5-1l13.5,13.5c0.6,0.6,0.6,1.5,0,2.1L73.8,51.4
  C72.9,52.3,71.3,51.7,71.3,50.4z" />
                        </g>
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2 " (click)="flipHorizontal()"
                    [container]="'body'" ngbTooltip="Flip Horizontal">

                    <svg version="1.0" width="28px" height="28px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <path fill="#171C37" d="M83.6,29.1c4.1,3.6,7,8.4,8.2,13.8c0.2,1.1,1.3,1.9,2.4,1.8l0,0c1.2-0.1,2.1-1.2,2-2.4c0-0.1,0-0.2,0-0.3
c-3.4-15.1-17.5-25.2-32.9-23.8c-10.4,1-19.6,7.3-24.4,16.6l3.8,2.4c6.4-13,22.2-18.3,35.2-11.9C79.9,26.3,81.9,27.6,83.6,29.1
L83.6,29.1z" />
                        <path fill="#0058A8" d="M51.5,40.4L33.8,25.8c-0.5-0.4-1.3-0.3-1.7,0.2c-0.2,0.2-0.3,0.5-0.3,0.9L33.3,43c0.1,0.7,0.7,1.2,1.3,1.1
c0,0,0,0,0,0l16.2-1.5c0.7-0.1,1.2-0.7,1.1-1.4C51.9,40.9,51.7,40.6,51.5,40.4z" />
                        <path fill="#171C37" d="M28.8,109.1c-0.6,0-1.2-0.1-1.8-0.4c-1.8-0.7-2.9-2.5-2.9-4.4V55.8c0-2.6,2.1-4.8,4.7-4.8
c1.2,0,2.4,0.5,3.3,1.3l25.2,23.2c1.9,1.8,2.1,4.8,0.3,6.7c0,0.1-0.1,0.1-0.1,0.1l-25.3,25.3C31.3,108.6,30.1,109.1,28.8,109.1z
M28.8,55.9v48.5l25.2-25.3L28.8,55.9z" />
                        <path fill="#171C37" d="M102.2,55.9v50.8c0,1.4-1.1,2.5-2.5,2.5c-0.7,0-1.3-0.3-1.8-0.7L71.6,82c-1-1-1-2.6,0-3.5c0,0,0,0,0.1-0.1
l26.4-24.3c1-0.9,2.6-0.9,3.5,0.1C102,54.7,102.3,55.3,102.2,55.9z" />
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2 " (click)="flipVertical()" [container]="'body'"
                    ngbTooltip="Flip Vertical">
                    <svg version="1.0" width="29px" height="29px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                        enable-background="new 0 0 128 128" xml:space="preserve">
                        <path fill="#171C37" d="M97.7,44.9c-3.6-4.1-8.4-7-13.8-8.2c-1.1-0.2-1.9-1.3-1.8-2.4l0,0c0.1-1.2,1.2-2.2,2.4-2c0.1,0,0.2,0,0.3,0
       c15.1,3.4,25.2,17.5,23.8,32.9c-1,10.4-7.3,19.6-16.6,24.4l-2.4-3.8c13-6.4,18.3-22.2,11.9-35.2C100.5,48.5,99.2,46.6,97.7,44.9
       L97.7,44.9z" />
                        <path fill="#0058A8" d="M86.4,77L101,94.7c0.4,0.5,0.3,1.3-0.2,1.7c-0.2,0.2-0.5,0.3-0.9,0.3l-16.2-1.5c-0.7-0.1-1.2-0.7-1.1-1.3
       c0,0,0,0,0,0l1.5-16.2c0.1-0.7,0.7-1.2,1.4-1.1C85.9,76.6,86.2,76.8,86.4,77z" />
                        <path fill="#171C37" d="M17.7,29.3c0-0.6,0.1-1.2,0.4-1.8c0.7-1.8,2.5-2.9,4.4-2.9H71c2.6,0,4.8,2.1,4.8,4.7c0,1.2-0.5,2.4-1.3,3.3
       L51.2,57.8c-0.9,0.9-2.1,1.5-3.4,1.5c-1.3,0-2.5-0.5-3.5-1.4L19.1,32.6C18.2,31.7,17.7,30.5,17.7,29.3z M70.9,29.3H22.5l25.3,25.2
       L70.9,29.3z" />
                        <path fill="#171C37" d="M70.8,102.7H20c-1.4,0-2.5-1.1-2.5-2.5c0-0.7,0.3-1.3,0.7-1.7L44.8,72c1-1,2.5-1,3.5,0c0,0,0,0.1,0.1,0.1
       l24.3,26.5c0.9,1,0.9,2.6-0.1,3.5C72.1,102.5,71.5,102.7,70.8,102.7z" />
                    </svg>
                </button>
                <button class="btn  btn-icon btn-icon-sm btn-clean mr-2 " (click)="toggleContainWithinAspectRatio()"
                    [container]="'body'"
                    [ngbTooltip]="!containWithinAspectRatio ? 'Content Aspect Ratio' :'Fill Aspect Ratio'">
                    <div class="d-inline" *ngIf="containWithinAspectRatio">
                        <svg version="1.0" width="25px" height="25px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                            enable-background="new 0 0 128 128" xml:space="preserve">
                            <path fill="#171C37" d="M100.5,109.5H27.5c-5,0-9.1-4.1-9.1-9.1V27.6c0-5,4.1-9.1,9.1-9.1h72.9c5,0,9.1,4.1,9.1,9.1v72.9
 C109.5,105.4,105.5,109.5,100.5,109.5z M27.5,23.8c-2.1,0-3.8,1.7-3.8,3.8v72.9c0,2.1,1.7,3.8,3.8,3.8h72.9c2.1,0,3.8-1.7,3.8-3.8
 V27.6c0-2.1-1.7-3.8-3.8-3.8H27.5z" />
                            <rect x="62.1" y="24.2" transform="matrix(0.7071 -0.7071 0.7071 0.7071 -26.5083 63.9962)"
                                fill="#0058A8" width="3.7" height="79.7" />
                            <path fill="#0058A8" d="M96,75.4v14.3c0,3.5-2.9,6.4-6.4,6.4H75.4c-1,0-1.8-0.8-1.8-1.8l0,0c0-1,0.8-1.8,1.8-1.8h14.2
 c1.5,0,2.7-1.2,2.7-2.7c0,0,0,0,0,0V75.4c0-1,0.8-1.9,1.8-1.9c0,0,0,0,0,0l0,0C95.2,73.5,96,74.3,96,75.4z" />
                            <path fill="#0058A8" d="M52.7,35.7H38.4c-1.5,0-2.7,1.2-2.7,2.7v0v14.2c0,1-0.8,1.8-1.8,1.8l0,0c-1,0-1.9-0.8-1.9-1.8c0,0,0,0,0,0
 V38.4c0-3.5,2.9-6.4,6.4-6.4h14.3c1,0,1.9,0.8,1.9,1.8c0,0,0,0,0,0l0,0C54.5,34.9,53.7,35.7,52.7,35.7z" />
                        </svg>
                    </div>
                    <div class="d-inline" *ngIf="!containWithinAspectRatio">
                        <svg version="1.0" width="25px" height="25px" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 128 128"
                            enable-background="new 0 0 128 128" xml:space="preserve">
                            <path fill="#171C37" d="M100.5,109.5H27.5c-5,0-9.1-4.1-9.1-9.1V27.6c0-5,4.1-9.1,9.1-9.1h72.9c5,0,9.1,4.1,9.1,9.1v72.9
 C109.5,105.4,105.5,109.5,100.5,109.5z M27.5,23.8c-2.1,0-3.8,1.7-3.8,3.8v72.9c0,2.1,1.7,3.8,3.8,3.8h72.9c2.1,0,3.8-1.7,3.8-3.8
 V27.6c0-2.1-1.7-3.8-3.8-3.8H27.5z" />
                            <path fill="#0058A8" d="M96,75.4v14.3c0,3.5-2.9,6.4-6.4,6.4H75.4c-1,0-1.8-0.8-1.8-1.8l0,0c0-1,0.8-1.8,1.8-1.8h14.2
 c1.5,0,2.7-1.2,2.7-2.7c0,0,0,0,0,0V75.4c0-1,0.8-1.9,1.8-1.9c0,0,0,0,0,0l0,0C95.2,73.5,96,74.3,96,75.4z" />
                            <path fill="#0058A8" d="M52.7,35.7H38.4c-1.5,0-2.7,1.2-2.7,2.7v0v14.2c0,1-0.8,1.8-1.8,1.8l0,0c-1,0-1.9-0.8-1.9-1.8c0,0,0,0,0,0
 V38.4c0-3.5,2.9-6.4,6.4-6.4h14.3c1,0,1.9,0.8,1.9,1.8c0,0,0,0,0,0l0,0C54.5,34.9,53.7,35.7,52.7,35.7z" />
                        </svg>
                    </div>
                </button>
            </div>

            <div class="row overflow-auto" style="max-height: calc(100vh - 200px)">
                <div class="col-md-8 overflow-hidden" style="max-height: calc(100vh - 205px)"
                    (mousewheel)="mousewheelHandler($event)">
                    <div>
                        <image-cropper
                            style="background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAQMAAAAlPW0iAAAAA3NCSVQICAjb4U/gAAAABlBMVEXMzMz////TjRV2AAAACXBIWXMAAArrAAAK6wGCiw1aAAAAHHRFWHRTb2Z0d2FyZQBBZG9iZSBGaXJld29ya3MgQ1M26LyyjAAAABFJREFUCJlj+M/AgBVhF/0PAH6/D/HkDxOGAAAAAElFTkSuQmCC);"
                            [containWithinAspectRatio]="false" [transform]="transform"
                            [imageChangedEvent]="options?.imageChangedEvent" [canvasRotation]="canvasRotation"
                            [maintainAspectRatio]="true" [aspectRatio]="aspectRatio" [roundCropper]="options?.round"
                            [cropperMinWidth]="200" [cropperMinHeight]="200" [format]="type" [imageQuality]="30"
                            (imageCropped)="imageCropped($event)"></image-cropper>
                    </div>
                </div>
                <div class="col-md-4 mt-2" *ngIf="croppedImage">
                    <img [defaultImage]="defaultImage" width="300px" height="300px"
                        [style.borderRadius]="options?.round ? '50%' : '0px'"
                        style="align-self: center;border-radius: 50%;" [lazyLoad]="bucketAwsUrl+croppedImage">
                </div>
            </div>
            <div>
            </div>


            <div class="modal-footer">
                <button type="button" class="btn btn-brand" (click)="activeModal.close()">Close</button>
                <button type="button" class="btn btn-brand" [disabled]="!croppedImage"
                    (click)="saveClickHandler()">Preview</button>
            </div>
        </app-loader>
    </div>
</app-base-modal>